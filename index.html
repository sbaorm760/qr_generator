<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Generator</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      width: 100vw;
      max-width: 100vw;
      background: linear-gradient(135deg, #e0e8f7 0%, #fffbe6 70%, #f4eba4 100%);
      font-family: "Segoe UI", "Noto Nastaliq Urdu", Arial, sans-serif;
    }
    body {
      min-height: 100vh;
      width: 100vw;
      box-sizing: border-box;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }
    .container {
      width: 100%;
      max-width: 430px;
      margin: 13px auto 0 auto;
      box-shadow: 0 6px 24px rgba(24,40,77,0.08), 0 1.5px 3px rgba(44,24,59,0.04);
      border-radius: 20px;
      background: #fff;
      overflow: visible;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      min-height: 0;
      box-sizing: border-box;
    }
    .header {
      background: #101d80;
      color: #fff;
      padding: 14px 12px 7px 12px;
      border-top-left-radius: 18px;
      border-top-right-radius: 18px;
      position: relative;
      min-height: 75px;
      overflow: visible;
    }
    .header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
    }
    .logo-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      flex: none;
      padding: 0;
      margin: 0;
      background: none !important;
    }
    .logo-svg {
      height: 54px; width: auto;
      min-width: 35px;
      border-radius: 0;
      box-shadow: none;
      display: block;
      background: none;
      margin-right: 1px;
      margin-left: 14px;
    }
    @media (max-width:480px) {
      .logo-svg { height: 41px; min-width: 24px;}
      .logo-wrapper { margin-left: 2px;}
      .header-row { gap: 4px;}
    }
    .header h1 {
      margin: 0 0 2px 0;
      font-size: 1.6rem;
      font-family: inherit;
      font-weight: 700;
    }
    .header small {
      font-size: 13px;
      opacity: 0.86;
    }
    .form-section {
      padding: 8px 10px 4px 10px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 7px;
      max-width: 100vw;
      box-sizing: border-box;
    }
    .dual-label {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      font-size: 15px;
      font-weight: bold;
      margin-left: 2px;
      margin-right: 2px;
      margin-bottom: 4px;
    }
    .dual-label .en {
      color: #1f244c;
      font-size: 15px;
      font-weight: bold;
      flex: 1;
      text-align: left;
    }
    .dual-label .ur {
      font-family: 'Noto Nastaliq Urdu', serif;
      color: #b53d10;
      font-size: 14px;
      flex: 1;
      text-align: right;
      font-weight: bold;
    }
    .input-box {
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 4px;
      box-sizing: border-box;
      max-width: 100vw;
    }
    .input-box input[type="text"] {
      width: 100%;
      min-width: 0;
      max-width: 100vw;
      padding: 10px 11px;
      border-radius: 7px;
      border: 1.2px solid #f5c46c;
      outline: none;
      font-size: 14px;
      background: #fdf7e3;
      color: #262626;
      margin-bottom: 1px;
      transition: border-color 0.2s;
      box-sizing: border-box;
    }
    .input-box input.urdu {
      direction: rtl;
      font-family: 'Noto Nastaliq Urdu', 'Segoe UI', Arial, sans-serif;
      text-align: right;
    }
    .input-box input[type="text"]:focus{
      border-color: #feb03c;
    }
    .input-box input[type="text"]::placeholder {
      color: #c49136;
      opacity: 1;
      font-size: 13px;
      font-weight: 400;
    }
    .form-grid {
      display: flex;
      flex-direction: column;
      gap: 7px;
      margin: 1px 0 2px 0;
    }
    .form-grid > div {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    label {
      font-size: 13px;
      margin-bottom: 2px;
    }
    select {
      width: 100%;
      padding: 7px 0px;
      font-size: 14px;
      border-radius: 6px;
      border: 1px solid #f5c46c;
      background: #fffae4;
      color: #28263d;
      outline: none;
      margin-bottom: 0;
      box-shadow: 0 0.5px 0.5px #eed19032;
      box-sizing: border-box;
      max-width: 100vw;
    }
    .preview {
      background: #f9f7ef;
      border: 2px dashed #ffad0e51;
      border-radius: 11px;
      margin: 10px auto 4px auto;
      width: 240px;
      height: 240px;
      min-width: 90px;
      min-height: 90px;
      max-width: 95vw;
      max-height: 95vw;
      display: flex;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      padding: 0;
      overflow: hidden;
      flex-direction: column;
      position: relative;
    }
    .preview-center {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .preview-label {
      font-size: 19px;
      color: #ad8b36;
      font-weight: bold;
      text-align: center;
      letter-spacing: 1px;
      z-index: 2;
      position: relative;
    }
    .preview-faint-logo {
      position: absolute;
      left: 50%; top: 54%;
      transform: translate(-50%, -50%);
      width: 88px;
      height: 88px;
      opacity: 0.11;
      z-index: 1;
      pointer-events: none;
    }
    .preview-inner {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 3;
    }
    .preview svg {
      max-width: 80%;
      max-height: 80%;
      width: auto;
      height: auto;
      display: block;
      margin: auto;
      background: transparent;
      border-radius: 0;
      box-shadow: 0 1px 4px #e9be6a21;
      box-sizing: border-box;
    }
    .downloads-row {
      display: flex;
      flex-direction: row;
      gap: 8px;
      justify-content: center;
      margin: 2px auto 1px auto;
      max-width: 280px;
      width:96%;
      box-sizing: border-box;
    }
    .downloads-row button {
      flex: 1 1 0;
      background: #101d80;
      color: #ffd71c;
      font-weight: 700;
      font-size: 14px;
      border: none;
      border-radius: 7px;
      padding: 8px 0;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      box-shadow: 0 2px 8px #c2a5271a;
      width: 100%;
      margin: 0;
      box-sizing: border-box;
      max-width: 100vw;
    }
    .downloads-row button:hover {
      background: #ffb428;
      color: #101d80;
    }
    .download-count {
      text-align: center;
      color: #ac7d00;
      font-weight: bold;
      font-size: 13.5px;
      margin: 2px 0 0 0;
      letter-spacing: 0.4px;
    }
    .footer {
      background: #f6f5ef;
      padding: 9px 9px 8px 9px;
      font-size: 14px;
      color: #3d3122;
      border-top: 1px solid #ffad0e33;
      border-bottom-right-radius: 14px;
      border-bottom-left-radius: 14px;
      margin-top: 1px;
      font-weight: 600;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      max-width: 100vw;
      text-align: center;
      letter-spacing: 0.3px;
    }
    .footer span, .footer a {
      display: inline-block;
      margin: 0 5px;
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.2px;
      color: #3d3122;
      vertical-align: middle;
      text-decoration: none;
      padding: 0;
    }
    @media (max-width:420px) {
      .container { max-width:99vw;}
      .preview { width:65vw; height:65vw; min-width:65px; min-height:65px;}
      .downloads-row { max-width:95vw; }
      .footer span, .footer a { font-size: 13.6px;}
    }
    @media (min-width:600px) {
      .container { max-width:430px;}
      .form-section{padding: 13px 18px 7px 18px;}
      .header{padding:18px 18px 7px 18px;}
      .dual-label .en{font-size:16px;}
      .dual-label .ur{font-size:15px;}
      .preview{max-width:210px;max-height:210px;}
      .downloads-row{gap:10px;max-width:280px;}
      .footer span, .footer a { font-size: 15px;}
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="header-row">
        <div>
          <h1>QR Generator</h1>
          <small>by SM Graphics</small>
        </div>
        <div class="logo-wrapper">
          <svg class="logo-svg" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg">
            <!-- logo SVG code ... -->
            <defs>
              <style type="text/css"><![CDATA[
                .fil0 {fill:#00A0E3}
                .fil3 {fill:#2B2A29}
                .fil1 {fill:#E5097F}
                .fil4 {fill:#FEFEFE}
                .fil2 {fill:#FFED00}
                .fil5 {fill:#EF7F1A;fill-rule:nonzero}
              ]]></style>
            </defs>
            <g id="Layer_x0020_1">
              <metadata id="CorelCorpID_0Corel-Layer"/>
              <g id="_2553399560400">
                <path class="fil0" d="M422.49 86.12l-30.94 -66.35c-29.59,7.1 -57.98,17.28 -84.82,30.17l54.23 54.23c19.71,-7.78 40.28,-13.86 61.53,-18.05z"/>
                <path class="fil1" d="M403.85 17l27.27 67.53c18.05,-3.1 36.56,-4.85 55.43,-5.13l-2.49 -71.4c-27.45,0.5 -54.26,3.58 -80.21,9z"/>
                <path class="fil2" d="M499.93 8l-2.49 71.4c18.86,0.28 37.37,2.02 55.42,5.12l27.28 -67.52c-25.96,-5.42 -52.77,-8.5 -80.21,-9z"/>
                <path class="fil3" d="M592.44 19.76l-30.94 66.36c21.24,4.19 41.81,10.26 61.52,18.04l54.24 -54.23c-26.85,-12.89 -55.24,-23.06 -84.82,-30.17z"/>
                <path class="fil4" d="M542.51 204.89l50.5 50.52 159.35 -159.36c-19.32,-14.79 -39.93,-27.98 -61.65,-39.37l-148.2 148.21zm235.2 588.78l214.29 0 0 -71.42 -71.43 0 0 -571.46 71.43 0 0 -71.43 -121.94 0 -277.05 277.06 -299.73 -299.74c-21.71,11.39 -42.33,24.58 -61.64,39.37l411.88 411.9 -151.52 151.52 -252.53 -252.54c0,123.21 -13.72,87.29 50.5,151.52l202.03 202.03 252.53 -252.53 -101.01 -101.02 205.62 -205.64 0 520.96 -71.43 0 0 71.42zm-714.29 -642.88l0 571.46 -71.42 0 0 71.42 214.29 0 0 -71.42 -71.44 0 0 -520.96 357.15 357.16 50.51 -50.5 -428.58 -428.59 -121.93 0 0 71.43 71.42 0z"/>
                <path class="fil5" d="M112.71 910.39l-36.13 0c-0.12,-4.37 -1.67,-7.54 -4.66,-9.52 -3,-1.95 -7.82,-2.94 -14.53,-2.94l-9.05 0c-8.28,0 -13.72,1.57 -16.38,4.67 -2.66,3.13 -3.99,10.67 -3.99,22.59l0 22.95c0,11.79 1.33,19.27 3.99,22.4 2.66,3.1 8.1,4.67 16.38,4.67l10.04 0c7.11,0 12.09,-1.02 14.9,-3.1 2.81,-2.05 4.2,-5.59 4.2,-10.64l0 -5.44 -20.64 0 0 -26.08 55.87 0 0 23.85c0,18.82 -3.99,32.6 -11.99,41.23 -8,8.66 -20.64,12.97 -37.89,12.97l-24.53 0c-15.21,0 -26.7,-4.99 -34.55,-14.93 -7.82,-9.96 -11.75,-24.67 -11.75,-44.07l0 -21.19c0,-21.73 4.14,-37.61 12.4,-47.65 8.25,-10 21.29,-15.02 39.15,-15.02l19.62 0c14.5,0 26.36,3.74 35.64,11.19 9.27,7.47 13.9,16.84 13.9,28.15l0 5.91zm59.15 23.78l20.21 0c6.03,0 10.14,-1.08 12.3,-3.29 2.2,-2.17 3.28,-6.2 3.28,-12.08l0 -5.34c0,-5.91 -1.11,-10 -3.31,-12.21 -2.19,-2.2 -6.3,-3.32 -12.27,-3.32l-20.21 0 0 36.24zm-36.16 72.1l0 -139.4 54.37 0c20.76,0 34.98,2.81 42.7,8.47 7.73,5.65 11.59,15.56 11.59,29.72l0 11.22c0,9.42 -2.19,16.81 -6.61,22.14 -4.39,5.34 -10.91,8.57 -19.53,9.69 9.11,1.56 15.76,4.7 19.9,9.36 4.17,4.7 6.24,11.38 6.24,20.04l0 28.76 -36.9 0 0 -25.08c0,-5.95 -1.11,-10.04 -3.31,-12.25 -2.19,-2.2 -6.3,-3.32 -12.26,-3.32l-20.03 0 0 40.65 -36.16 0zm174.42 -52.73l29.52 0 -13.38 -57.75 -2.35 0 -13.79 57.75zm-51.51 52.73l38.75 -139.4 55.6 0 37.85 139.4 -38.75 0 -6.05 -24.35 -42.5 0 -6.15 24.35 -38.75 0zm149.26 0l0 -139.4 63.26 0c17.77,0 30.5,3.61 38.17,10.8 7.66,7.22 11.5,19.08 11.5,35.63l0 9.18c0,16.58 -3.84,28.5 -11.53,35.73 -7.7,7.25 -20.43,10.86 -38.14,10.86l-27.1 0 0 37.2 -36.16 0zm36.16 -68.26l25.19 0c5.93,0 9.86,-1.09 11.77,-3.29 1.95,-2.18 2.91,-6.59 2.91,-13.2l0 -8.06c0,-5.53 -1.24,-9.49 -3.68,-11.82 -2.44,-2.33 -6.58,-3.52 -12.45,-3.52l-23.74 0 0 39.89zm97.19 68.26l0 -139.4 36.16 0 0 52.16 47.1 0 0 -52.16 36.15 0 0 139.4 -36.15 0 0 -54.45 -47.1 0 0 54.45 -36.16 0zm147.97 0l0 -139.4 36.52 0 0 139.4 -36.52 0zm173.92 -53.69l0 4.03c0,18.18 -3.86,31.32 -11.59,39.34 -7.72,8.02 -20.33,12.05 -37.88,12.05l-12.24 0c-19.07,0 -32.42,-4.22 -40.08,-12.62 -7.67,-8.41 -11.5,-23.21 -11.5,-44.4l0 -28.89c0,-21.19 3.83,-35.95 11.5,-44.36 7.66,-8.4 21.01,-12.59 40.08,-12.59l9.98 0c18.91,0 32.11,3.68 39.59,11.06 7.48,7.35 11.21,20.36 11.21,38.96l0 2.71 -35.97 0 0 -2.52c0,-6.36 -1.42,-10.87 -4.26,-13.49 -2.81,-2.62 -7.79,-3.93 -14.83,-3.93 -7.79,0 -12.98,1.57 -15.58,4.67 -2.6,3.13 -3.89,10.64 -3.89,22.56l0 22.92c0,11.88 1.29,19.4 3.89,22.5 2.6,3.1 7.79,4.63 15.58,4.63 7.29,0 12.33,-1.44 15.1,-4.28 2.79,-2.85 4.18,-7.9 4.18,-15.15l0 -3.2 36.71 0zm15.95 10.55l34.67 0 0 1.41c0,5.04 1.3,8.56 3.9,10.54 2.59,2.02 7.17,3.01 13.75,3.01l9.05 0c5.51,0 9.34,-0.77 11.53,-2.3 2.2,-1.51 3.31,-4.22 3.31,-8.09l0 -6.07c0,-3.29 -0.87,-5.69 -2.63,-7.1 -1.73,-1.44 -5.69,-2.55 -11.84,-3.29l-29.32 -3.29c-10.91,-1.25 -18.92,-4.76 -23.95,-10.61 -5.04,-5.85 -7.55,-14.51 -7.55,-25.99l0 -8.62c0,-6.49 1,-12.28 3,-17.39 1.98,-5.08 4.89,-9.27 8.69,-12.5 3.24,-2.81 7.2,-4.82 11.83,-5.97 4.64,-1.15 11.59,-1.73 20.8,-1.73l21.66 0c13.48,0 23.77,2.81 30.88,8.44 7.14,5.62 10.69,13.74 10.69,24.38l0 9.56 -34.67 0 0 -1.5c0,-4.19 -0.96,-7.1 -2.84,-8.73 -1.92,-1.63 -5.35,-2.43 -10.3,-2.43l-8.34 0c-5.75,0 -9.67,0.71 -11.84,2.11 -2.13,1.41 -3.21,3.84 -3.21,7.26l0 5.81c0,5.12 4.85,8.25 14.59,9.37l0 0 26.7 3.1c11.56,1.37 20.14,4.82 25.83,10.42 5.69,5.59 8.53,13.45 8.53,23.55l0 13.39c0,11.54 -3.46,20.78 -10.41,27.71 -6.96,6.94 -16.29,10.42 -28,10.42l-29.45 0c-15.73,0 -27.2,-2.81 -34.34,-8.44 -7.14,-5.62 -10.72,-14.57 -10.72,-26.81l0 -9.62z"/>
              </g>
            </g>
          </svg>
        </div>
      </div>
    </div>
    <form class="form-section" onsubmit="return false;">
      <div class="dual-label">
        <span class="en">Link or Text</span>
        <span class="ur">لنک یا متن</span>
      </div>
      <div class="input-box">
        <input type="text" id="qrText" placeholder="Enter text or link" oninput="detectLang(this); generateQR();">
      </div>
      <div class="form-grid">
        <div>
          <label>Protection Level</label>
          <select id="qrLevel" onchange="generateQR()">
            <option value="L">Low (کم)</option>
            <option value="M" selected>Medium (درمیانہ)</option>
            <option value="Q">High (بہت)</option>
            <option value="H">Highest (بہت زیادہ)</option>
          </select>
        </div>
        <div>
          <label>Size</label>
          <select id="qrSize" onchange="generateQR()">
            <option value="236.22">20mm</option>
            <option value="354.33" selected>30mm</option>
            <option value="472.44">40mm</option>
            <option value="590.55">50mm</option>
            <option value="1181.10">100mm</option>
          </select>
        </div>
      </div>
    </form>
    <div class="preview" id="qrPreview"></div>
    <div class="downloads-row">
      <button onclick="downloadQR('png')">Download PNG</button>
      <button onclick="downloadQR('svg')">Download SVG</button>
    </div>
    <div class="download-count" id="downloadCount">
      Downloads: 0
    </div>
    <div class="footer">
      <span>✆ +91 9000 914 223 | ✉︎ <a href="mailto:smgfx4u@gmail.com">smgfx4u@gmail.com</a></span>
    </div>
  </div>
  <script>
    let downloadCounter = 0;
    let lastSvgTag = '';
    let lastDataUrl = '';
    function detectLang(input) {
      const urduRange = /[\u0600-\u06FF]/;
      if (urduRange.test(input.value)) {
        input.classList.add("urdu");
      } else {
        input.classList.remove("urdu");
      }
    }
    function generateQR() {
      const qrText = document.getElementById('qrText').value;
      const qrLevel = document.getElementById('qrLevel').value;
      const qrSize = parseFloat(document.getElementById('qrSize').value);
      const margin = 4;
      const qrPreview = document.getElementById('qrPreview');
      if (!qrText.trim()) {
        qrPreview.innerHTML =
          `<div class="preview-center">
            <span class="preview-label">QR Preview</span>
            <span class="preview-faint-logo">
              <svg viewBox="0 0 1000 1000" width="88" height="88" xmlns="http://www.w3.org/2000/svg">
                <defs>
                  <style type="text/css"><![CDATA[
                    .fil0 {fill:#00A0E3}
                    .fil3 {fill:#2B2A29}
                    .fil1 {fill:#E5097F}
                    .fil4 {fill:#FEFEFE}
                    .fil2 {fill:#FFED00}
                    .fil5 {fill:#EF7F1A;fill-rule:nonzero}
                  ]]></style>
                </defs>
                <g><g>
                  <path class="fil0" d="M422.49 86.12l-30.94 -66.35c-29.59,7.1 -57.98,17.28 -84.82,30.17l54.23 54.23c19.71,-7.78 40.28,-13.86 61.53,-18.05z"/>
                  <path class="fil1" d="M403.85 17l27.27 67.53c18.05,-3.1 36.56,-4.85 55.43,-5.13l-2.49 -71.4c-27.45,0.5 -54.26,3.58 -80.21,9z"/>
                  <path class="fil2" d="M499.93 8l-2.49 71.4c18.86,0.28 37.37,2.02 55.42,5.12l27.28 -67.52c-25.96,-5.42 -52.77,-8.5 -80.21,-9z"/>
                  <path class="fil3" d="M592.44 19.76l-30.94 66.36c21.24,4.19 41.81,10.26 61.52,18.04l54.24 -54.23c-26.85,-12.89 -55.24,-23.06 -84.82,-30.17z"/>
                  <path class="fil4" d="M542.51 204.89l50.5 50.52 159.35 -159.36c-19.32,-14.79 -39.93,-27.98 -61.65,-39.37l-148.2 148.21zm235.2 588.78l214.29 0 0 -71.42 -71.43 0 0 -571.46 71.43 0 0 -71.43 -121.94 0 -277.05 277.06 -299.73 -299.74c-21.71,11.39 -42.33,24.58 -61.64,39.37l411.88 411.9 -151.52 151.52 -252.53 -252.54c0,123.21 -13.72,87.29 50.5,151.52l202.03 202.03 252.53 -252.53 -101.01 -101.02 205.62 -205.64 0 520.96 -71.43 0 0 71.42zm-714.29 -642.88l0 571.46 -71.42 0 0 71.42 214.29 0 0 -71.42 -71.44 0 0 -520.96 357.15 357.16 50.51 -50.5 -428.58 -428.59 -121.93 0 0 71.43 71.42 0z"/>
                  <path class="fil5" d="M112.71 910.39l-36.13 0c-0.12,-4.37 -1.67,-7.54 -4.66,-9.52 -3,-1.95 -7.82,-2.94 -14.53,-2.94l-9.05 0c-8.28,0 -13.72,1.57 -16.38,4.67 -2.66,3.13 -3.99,10.67 -3.99,22.59l0 22.95c0,11.79 1.33,19.27 3.99,22.4 2.66,3.1 8.1,4.67 16.38,4.67l10.04 0c7.11,0 12.09,-1.02 14.9,-3.1 2.81,-2.05 4.2,-5.59 4.2,-10.64l0 -5.44 -20.64 0 0 -26.08 55.87 0 0 23.85c0,18.82 -3.99,32.6 -11.99,41.23 -8,8.66 -20.64,12.97 -37.89,12.97l-24.53 0c-15.21,0 -26.7,-4.99 -34.55,-14.93 -7.82,-9.96 -11.75,-24.67 -11.75,-44.07l0 -21.19c0,-21.73 4.14,-37.61 12.4,-47.65 8.25,-10 21.29,-15.02 39.15,-15.02l19.62 0c14.5,0 26.36,3.74 35.64,11.19 9.27,7.47 13.9,16.84 13.9,28.15l0 5.91zm59.15 23.78l20.21 0c6.03,0 10.14,-1.08 12.3,-3.29 2.2,-2.17 3.28,-6.2 3.28,-12.08l0 -5.34c0,-5.91 -1.11,-10 -3.31,-12.21 -2.19,-2.2 -6.3,-3.32 -12.27,-3.32l-20.21 0 0 36.24zm-36.16 72.1l0 -139.4 54.37 0c20.76,0 34.98,2.81 42.7,8.47 7.73,5.65 11.59,15.56 11.59,29.72l0 11.22c0,9.42 -2.19,16.81 -6.61,22.14 -4.39,5.34 -10.91,8.57 -19.53,9.69 9.11,1.56 15.76,4.7 19.9,9.36 4.17,4.7 6.24,11.38 6.24,20.04l0 28.76 -36.9 0 0 -25.08c0,-5.95 -1.11,-10.04 -3.31,-12.25 -2.19,-2.2 -6.3,-3.32 -12.26,-3.32l-20.03 0 0 40.65 -36.16 0zm174.42 -52.73l29.52 0 -13.38 -57.75 -2.35 0 -13.79 57.75zm-51.51 52.73l38.75 -139.4 55.6 0 37.85 139.4 -38.75 0 -6.05 -24.35 -42.5 0 -6.15 24.35 -38.75 0zm149.26 0l0 -139.4 63.26 0c17.77,0 30.5,3.61 38.17,10.8 7.66,7.22 11.5,19.08 11.5,35.63l0 9.18c0,16.58 -3.84,28.5 -11.53,35.73 -7.7,7.25 -20.43,10.86 -38.14,10.86l-27.1 0 0 37.2 -36.16 0zm36.16 -68.26l25.19 0c5.93,0 9.86,-1.09 11.77,-3.29 1.95,-2.18 2.91,-6.59 2.91,-13.2l0 -8.06c0,-5.53 -1.24,-9.49 -3.68,-11.82 -2.44,-2.33 -6.58,-3.52 -12.45,-3.52l-23.74 0 0 39.89zm97.19 68.26l0 -139.4 36.16 0 0 52.16 47.1 0 0 -52.16 36.15 0 0 139.4 -36.15 0 0 -54.45 -47.1 0 0 54.45 -36.16 0zm147.97 0l0 -139.4 36.52 0 0 139.4 -36.52 0zm173.92 -53.69l0 4.03c0,18.18 -3.86,31.32 -11.59,39.34 -7.72,8.02 -20.33,12.05 -37.88,12.05l-12.24 0c-19.07,0 -32.42,-4.22 -40.08,-12.62 -7.67,-8.41 -11.5,-23.21 -11.5,-44.4l0 -28.89c0,-21.19 3.83,-35.95 11.5,-44.36 7.66,-8.4 21.01,-12.59 40.08,-12.59l9.98 0c18.91,0 32.11,3.68 39.59,11.06 7.48,7.35 11.21,20.36 11.21,38.96l0 2.71 -35.97 0 0 -2.52c0,-6.36 -1.42,-10.87 -4.26,-13.49 -2.81,-2.62 -7.79,-3.93 -14.83,-3.93 -7.79,0 -12.98,1.57 -15.58,4.67 -2.6,3.13 -3.89,10.64 -3.89,22.56l0 22.92c0,11.88 1.29,19.4 3.89,22.5 2.6,3.1 7.79,4.63 15.58,4.63 7.29,0 12.33,-1.44 15.1,-4.28 2.79,-2.85 4.18,-7.9 4.18,-15.15l0 -3.2 36.71 0zm15.95 10.55l34.67 0 0 1.41c0,5.04 1.3,8.56 3.9,10.54 2.59,2.02 7.17,3.01 13.75,3.01l9.05 0c5.51,0 9.34,-0.77 11.53,-2.3 2.2,-1.51 3.31,-4.22 3.31,-8.09l0 -6.07c0,-3.29 -0.87,-5.69 -2.63,-7.1 -1.73,-1.44 -5.69,-2.55 -11.84,-3.29l-29.32 -3.29c-10.91,-1.25 -18.92,-4.76 -23.95,-10.61 -5.04,-5.85 -7.55,-14.51 -7.55,-25.99l0 -8.62c0,-6.49 1,-12.28 3,-17.39 1.98,-5.08 4.89,-9.27 8.69,-12.5 3.24,-2.81 7.2,-4.82 11.83,-5.97 4.64,-1.15 11.59,-1.73 20.8,-1.73l21.66 0c13.48,0 23.77,2.81 30.88,8.44 7.14,5.62 10.69,13.74 10.69,24.38l0 9.56 -34.67 0 0 -1.5c0,-4.19 -0.96,-7.1 -2.84,-8.73 -1.92,-1.63 -5.35,-2.43 -10.3,-2.43l-8.34 0c-5.75,0 -9.67,0.71 -11.84,2.11 -2.13,1.41 -3.21,3.84 -3.21,7.26l0 5.81c0,5.12 4.85,8.25 14.59,9.37l0 0 26.7 3.1c11.56,1.37 20.14,4.82 25.83,10.42 5.69,5.59 8.53,13.45 8.53,23.55l0 13.39c0,11.54 -3.46,20.78 -10.41,27.71 -6.96,6.94 -16.29,10.42 -28,10.42l-29.45 0c-15.73,0 -27.2,-2.81 -34.34,-8.44 -7.14,-5.62 -10.72,-14.57 -10.72,-26.81l0 -9.62z"/>
                </g></g>
              </svg>
            </span>
          </div>`;
        lastSvgTag = '';
        lastDataUrl = '';
        return;
      }
      const qr = qrcode(0, qrLevel);
      qr.addData(qrText);
      qr.make();
      let svgTag = qr.createSvgTag(qrSize, margin);
      svgTag = svgTag.replace(/<rect[^>]*fill="[^"]*"[^>]*>/, '');
      svgTag = svgTag.replace(/width="[^"]*"/, `width="${qrSize}px"`)
                     .replace(/height="[^"]*"/, `height="${qrSize}px"`);
      lastSvgTag = svgTag;
      let previewSvg = svgTag.replace(/(width|height)="[^"]*"/g, '');
      qrPreview.innerHTML = `<div class="preview-inner">${previewSvg}</div>`;
      lastDataUrl = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgTag);

      const img = new Image();
      img.onload = function() {
        const canvas = document.createElement('canvas');
        canvas.width = qrSize;
        canvas.height = qrSize;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, qrSize, qrSize);
        document.getElementById('savePngData')?.remove();
        let pngBtn = document.createElement('a');
        pngBtn.id = 'savePngData';
        pngBtn.style.display = 'none';
        pngBtn.download = 'qrcode.png';
        pngBtn.href = canvas.toDataURL('image/png');
        document.body.appendChild(pngBtn);
      };
      img.src = lastDataUrl;
    }
    window.onload = function() { generateQR(); };
    function downloadQR(type) {
      if (!lastSvgTag) {
        alert("Please enter some text or a link first!");
        return;
      }
      downloadCounter++;
      document.getElementById("downloadCount").innerText = "Downloads: " + downloadCounter;
      if (type === 'svg') {
        const link = document.createElement('a');
        link.download = 'qrcode.svg';
        link.href = lastDataUrl;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      } else if (type === 'png') {
        const pngBtn = document.getElementById('savePngData');
        if (pngBtn) {
          pngBtn.click();
        } else {
          alert('Please generate QR again!');
        }
      }
    }
  </script>
</body>
</html>
